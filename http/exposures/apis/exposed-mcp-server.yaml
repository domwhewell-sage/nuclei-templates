id: exposed-mcp-server

info:
  name: Exposed MCP Streamable HTTP API Detection
  author: domwhewell-sage
  severity: unknown
  description: |
    Detects exposed Machine Control Protocol (MCP) servers through Streamable HTTP API endpoints.
    MCP servers often provide administrative access to AI tools, LLM systems, or other automation infrastructure.
    Exposed MCP interfaces can lead to unauthorized access, information disclosure, and potential system compromise.
    This template sends an InitializeRequest and expects an InitializeResult.
  metadata:
    verified: true
  reference:
    - https://modelcontextprotocol.io/specification/2025-03-26/basic/transports#streamable-http
  tags: mcp,jsonrpc,devtools,exposure,api,ai,llm

http:
  - method: POST
    path:
      - "{{BaseURL}}"
      - "{{BaseURL}}/mcp"

    headers:
      Content-Type: application/json

    body: |
      {
        "method":"initialize",
        "params":{
          "protocolVersion":"2025-03-26",
          "capabilities":{
            "sampling":{},
            "roots":{
              "listChanged":true
            }
          },
          "clientInfo":{
            "name":"mcp-inspector",
            "version":"0.14.0"
          }
        },
        "jsonrpc":"2.0",
        "id":0
      }

    matchers-condition: and
    matchers:
      - type: word
        part: headers
        words:
          - "application/json"

      - type: word
        part: body
        words:
          - "capabilities"
          - "serverInfo"
        condition: and

    extractors:
      - type: regex
        part: body
        regex:
          - "\"name\"\\s*:\\s*\"([^\"]+)\""